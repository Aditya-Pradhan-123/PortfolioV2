import { useEffect, useRef } from "react";
import { gsap } from "gsap";
import Lenis from "@studio-freight/lenis";

import { ScrollTrigger } from "gsap/ScrollTrigger";
import { useLocation } from "react-router-dom";

export default function NavBar({ sectionRefs }) {

  const location = useLocation()

  const isContactPage = location.pathname === '/contact';

  const navBar = useRef(null);
  const logo = useRef(null);
  const cta = useRef(null);
  const tl = gsap.timeline();
  gsap.registerPlugin(ScrollTrigger);

  useEffect(() => {
    const lenis = new Lenis();
    function raf(time) {
      lenis.raf(time);
      requestAnimationFrame(raf);
    }
    requestAnimationFrame(raf);
  });

  useEffect(() => {
    tl.to(navBar.current, {
      y: 0,
      duration: 1,
      delay: 0.5,
      ease: "power4.inOut",
    });
  });


  useEffect(() => {
    sectionRefs.forEach((section) => {
      ScrollTrigger.create({
        trigger: section,
        start: "top 375px",
        end: "bottom 300px",
        // markers: true,
        animation: gsap
          .timeline()
          .to(navBar.current, { color: "#DDDDD5" })
          .to(cta.current, { backgroundColor: "#D1D1C7", color: "#0E0E0C" }, 0)
          .to(".bg-secondary-100", { backgroundColor: "#0E0E0C" }, 0),

        toggleActions: "restart reverse restart reverse",
      });
    });

  });

  return (
    <header
      ref={navBar}
      className="fixed top-0 z-50 flex w-full -translate-y-full items-center justify-between bg-secondary-100 px-5 py-3"
    >
      {/* logo */}
      <a href="/" aria-label="Logo" className="z-50">
        {/* <svg
          ref={logo}
          width="80"
          height="45"
          viewBox="0 0 121 45"
          fill="currentColor"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path d="M10.08 25.3774V36.6974H3.24V7.97739H10.08V17.4974C10.8533 16.6441 11.68 15.9774 12.56 15.4974C13.44 15.0174 14.56 14.7774 15.92 14.7774C18.0533 14.7774 19.7867 15.4707 21.12 16.8574C22.48 18.2441 23.16 20.2441 23.16 22.8574V36.6974H16.32V25.1374C16.32 23.7774 16.0667 22.7374 15.56 22.0174C15.08 21.2974 14.32 20.9374 13.28 20.9374C12.72 20.9374 12.1867 21.0841 11.68 21.3774C11.2 21.6707 10.8133 22.1374 10.52 22.7774C10.2267 23.4174 10.08 24.2841 10.08 25.3774ZM38.2188 27.4574V15.1774H45.0588V36.6974H38.7788V34.3774C38.1921 35.1774 37.3521 35.8307 36.2588 36.3374C35.1921 36.8441 34.0321 37.0974 32.7788 37.0974C31.3654 37.0974 30.0854 36.8041 28.9388 36.2174C27.7921 35.6041 26.8854 34.6841 26.2188 33.4574C25.5788 32.2041 25.2588 30.6307 25.2588 28.7374V15.1774H32.0988V27.4574C32.0988 28.6307 32.3654 29.5107 32.8988 30.0974C33.4588 30.6841 34.2188 30.9774 35.1788 30.9774C35.6321 30.9774 36.0854 30.8574 36.5388 30.6174C37.0188 30.3507 37.4188 29.9641 37.7388 29.4574C38.0588 28.9241 38.2188 28.2574 38.2188 27.4574ZM68.2013 15.1774L57.9613 44.4174H50.4813L53.4813 36.4574L45.0812 15.1774H52.5213L57.1613 28.4974L61.3213 15.1774H68.2013ZM75.0956 25.3774V36.6974H68.2556V15.1774H74.5356V17.7774C75.389 16.8441 76.3223 16.1107 77.3356 15.5774C78.3756 15.0441 79.5756 14.7774 80.9356 14.7774C83.069 14.7774 84.8023 15.4707 86.1356 16.8574C87.4956 18.2441 88.1756 20.2441 88.1756 22.8574V36.6974H81.3356V25.1374C81.3356 23.7774 81.0823 22.7374 80.5756 22.0174C80.0956 21.2974 79.3356 20.9374 78.2956 20.9374C77.7356 20.9374 77.2023 21.0841 76.6956 21.3774C76.2156 21.6707 75.829 22.1374 75.5356 22.7774C75.2423 23.4174 75.0956 24.2841 75.0956 25.3774ZM100.074 44.8174C98.101 44.8174 96.3544 44.4707 94.8344 43.7774C93.3144 43.1107 92.1144 42.1507 91.2344 40.8974C90.3544 39.6441 89.8744 38.1907 89.7944 36.5374H96.4344C96.5677 37.4974 96.9277 38.2307 97.5144 38.7374C98.1277 39.2441 98.9677 39.4974 100.034 39.4974C101.314 39.4974 102.274 39.1641 102.914 38.4974C103.581 37.8307 103.914 36.8441 103.914 35.5374V33.0174C103.354 33.8174 102.594 34.4441 101.634 34.8974C100.674 35.3507 99.6077 35.5774 98.4344 35.5774C96.701 35.5774 95.1277 35.1241 93.7144 34.2174C92.301 33.2841 91.181 32.0307 90.3544 30.4574C89.5277 28.8841 89.1144 27.1241 89.1144 25.1774C89.1144 23.1507 89.501 21.3641 90.2744 19.8174C91.0477 18.2441 92.1144 17.0174 93.4744 16.1374C94.8344 15.2307 96.3944 14.7774 98.1544 14.7774C99.5144 14.7774 100.701 14.9907 101.714 15.4174C102.728 15.8174 103.648 16.4707 104.474 17.3774V15.1774H110.754V35.4574C110.754 38.3641 109.794 40.6441 107.874 42.2974C105.981 43.9774 103.381 44.8174 100.074 44.8174ZM96.0344 25.2174C96.0344 26.5507 96.381 27.6174 97.0744 28.4174C97.7677 29.2174 98.6877 29.6174 99.8344 29.6174C100.634 29.6174 101.328 29.4307 101.914 29.0574C102.528 28.6841 102.994 28.1641 103.314 27.4974C103.661 26.8307 103.834 26.0574 103.834 25.1774C103.834 23.8441 103.461 22.7774 102.714 21.9774C101.994 21.1507 101.034 20.7374 99.8344 20.7374C98.6877 20.7374 97.7677 21.1507 97.0744 21.9774C96.381 22.7774 96.0344 23.8574 96.0344 25.2174Z" />
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M113.5 1.5H111V6.50001H113.5C112.119 6.50001 111 7.61931 111 9.00001V11.5H116V9.00001C116 10.3807 117.119 11.5 118.5 11.5H121V6.50001H118.5C119.881 6.50001 121 5.38072 121 4V1.5H116V4C116 2.61929 114.881 1.5 113.5 1.5ZM116 6.50001H113.5C114.881 6.50001 116 7.61931 116 9.00001V6.50001ZM116 6.50001V4C116 5.38072 117.119 6.50001 118.5 6.50001H116Z"
          />
        </svg> */}
        <svg ref={logo} width="111" height="47" viewBox="0 0 111 47" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M0.72 36L9.9 10.8H16.092L25.272 36H19.548L12.96 16.884L6.372 36H0.72ZM4.716 30.492L6.156 26.316H19.368L20.772 30.492H4.716ZM33.5759 36.432C31.9679 36.432 30.5039 36.024 29.1839 35.208C27.8879 34.392 26.8559 33.276 26.0879 31.86C25.3439 30.42 24.9719 28.788 24.9719 26.964C24.9719 25.116 25.3559 23.484 26.1239 22.068C26.8919 20.628 27.9359 19.5 29.2559 18.684C30.5999 17.844 32.0879 17.424 33.7199 17.424C34.9679 17.424 36.0599 17.652 36.9959 18.108C37.9319 18.54 38.6999 19.176 39.2999 20.016V10.08H44.6999V36H39.9119L39.2999 33.66C38.9399 34.164 38.4959 34.632 37.9679 35.064C37.4639 35.472 36.8519 35.796 36.1319 36.036C35.4119 36.3 34.5599 36.432 33.5759 36.432ZM34.9799 31.716C35.8679 31.716 36.6479 31.512 37.3199 31.104C38.0159 30.696 38.5439 30.132 38.9039 29.412C39.2879 28.692 39.4799 27.864 39.4799 26.928C39.4799 25.992 39.2879 25.164 38.9039 24.444C38.5439 23.724 38.0159 23.16 37.3199 22.752C36.6479 22.344 35.8679 22.14 34.9799 22.14C34.1159 22.14 33.3359 22.344 32.6399 22.752C31.9679 23.16 31.4399 23.724 31.0559 24.444C30.6719 25.164 30.4799 25.98 30.4799 26.892C30.4799 27.828 30.6719 28.668 31.0559 29.412C31.4399 30.132 31.9679 30.696 32.6399 31.104C33.3359 31.512 34.1159 31.716 34.9799 31.716ZM47.455 36V17.856H52.855V36H47.455ZM50.155 15.768C49.195 15.768 48.415 15.492 47.815 14.94C47.215 14.388 46.915 13.692 46.915 12.852C46.915 11.988 47.215 11.28 47.815 10.728C48.415 10.176 49.195 9.9 50.155 9.9C51.139 9.9 51.931 10.176 52.531 10.728C53.155 11.28 53.467 11.988 53.467 12.852C53.467 13.692 53.155 14.388 52.531 14.94C51.931 15.492 51.139 15.768 50.155 15.768ZM64.1094 36C62.7894 36 61.6254 35.796 60.6174 35.388C59.6094 34.956 58.8294 34.26 58.2774 33.3C57.7254 32.34 57.4494 31.032 57.4494 29.376V22.356H54.3534V17.856H57.4494L58.0254 12.744H62.8494V17.856H67.4934V22.356H62.8494V29.448C62.8494 30.168 63.0054 30.684 63.3174 30.996C63.6534 31.284 64.2174 31.428 65.0094 31.428H67.4934V36H64.1094ZM72.0567 43.92L76.4127 33.984H75.3327L68.0247 17.856H73.8927L78.8967 28.908L83.0727 17.856H88.8687L77.7807 43.92H72.0567ZM94.5437 36.432C93.0317 36.432 91.7717 36.192 90.7637 35.712C89.7797 35.232 89.0477 34.584 88.5677 33.768C88.1117 32.928 87.8837 32.004 87.8837 30.996C87.8837 29.916 88.1477 28.968 88.6757 28.152C89.2277 27.312 90.0797 26.652 91.2317 26.172C92.3837 25.668 93.8357 25.416 95.5877 25.416H99.9797C99.9797 24.6 99.8717 23.928 99.6557 23.4C99.4637 22.872 99.1397 22.476 98.6837 22.212C98.2277 21.948 97.6037 21.816 96.8117 21.816C95.9717 21.816 95.2637 21.984 94.6877 22.32C94.1117 22.656 93.7517 23.184 93.6077 23.904H88.4237C88.5437 22.608 88.9637 21.48 89.6837 20.52C90.4277 19.56 91.4117 18.804 92.6357 18.252C93.8597 17.7 95.2637 17.424 96.8477 17.424C98.5757 17.424 100.076 17.712 101.348 18.288C102.62 18.84 103.604 19.656 104.3 20.736C105.02 21.816 105.38 23.16 105.38 24.768V36H100.88L100.232 33.372C99.9677 33.828 99.6557 34.248 99.2957 34.632C98.9357 34.992 98.5157 35.316 98.0357 35.604C97.5557 35.868 97.0277 36.072 96.4517 36.216C95.8757 36.36 95.2397 36.432 94.5437 36.432ZM95.8757 32.328C96.4517 32.328 96.9557 32.232 97.3877 32.04C97.8197 31.848 98.1917 31.584 98.5037 31.248C98.8157 30.912 99.0677 30.528 99.2597 30.096C99.4757 29.64 99.6317 29.148 99.7277 28.62V28.584H96.2357C95.6357 28.584 95.1317 28.668 94.7237 28.836C94.3397 28.98 94.0517 29.196 93.8597 29.484C93.6677 29.772 93.5717 30.108 93.5717 30.492C93.5717 30.9 93.6677 31.248 93.8597 31.536C94.0757 31.8 94.3517 32.004 94.6877 32.148C95.0477 32.268 95.4437 32.328 95.8757 32.328Z" fill="currentColor"/>
        <path fill-rule="evenodd" clip-rule="evenodd" d="M103.5 3H101V8.00001H103.5C102.119 8.00001 101 9.11931 101 10.5V13H106V10.5C106 11.8807 107.119 13 108.5 13H111V8.00001H108.5C109.881 8.00001 111 6.88072 111 5.5V3H106V5.5C106 4.11929 104.881 3 103.5 3ZM106 8.00001H103.5C104.881 8.00001 106 9.11931 106 10.5V8.00001ZM106 8.00001V5.5C106 6.88072 107.119 8.00001 108.5 8.00001H106Z" fill="currentColor"/>
        </svg>
      </a>

      {
        !isContactPage && 
        <nav className=" space-x-7 font-grotesk text-body-3 sm:block">
        <a href="#about" className="group relative hidden md:inline-block">
          <span>about</span>
          <span className="absolute bottom-0 left-0 h-[0.125em] w-0 rounded-full bg-secondary-600 duration-300 ease-in-out group-hover:w-full"></span>
        </a>
        <a href="#services" className="group relative hidden md:inline-block">
          <span>services</span>
          <span className="absolute bottom-0 left-0 h-[0.125em] w-0 rounded-full bg-secondary-600 duration-300 ease-in-out group-hover:w-full"></span>
        </a>
        <a href="#works" className="group relative hidden md:inline-block">
          <span>projects</span>
          <span className="absolute bottom-0 left-0 h-[0.125em] w-0 rounded-full bg-secondary-600 duration-300 ease-in-out group-hover:w-full"></span>
        </a>
        <a
          ref={cta}
          className="button group relative hover:bg-transparent"
          href="#contact"
        >
          <span className="relative w-fit">
            <span className="absolute bottom-2 h-[0.15em] w-0 bg-secondary-700 opacity-90 duration-300 ease-out group-hover:w-full"></span>
            <span>Let&apos;s Talk.</span>
          </span>
        </a>
      </nav>
      }

      
    </header>
  );
}
